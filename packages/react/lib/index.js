"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var r=require("@dura/core"),e=require("react"),t=require("@dura/utils"),n=function(){return(n=Object.assign||function(r){for(var e,t=1,n=arguments.length;t<n;t++)for(var u in e=arguments[t])Object.prototype.hasOwnProperty.call(e,u)&&(r[u]=e[u]);return r}).apply(this,arguments)};function u(){for(var r=0,e=0,t=arguments.length;e<t;e++)r+=arguments[e].length;var n=Array(r),u=0;for(e=0;e<t;e++)for(var c=arguments[e],o=0,a=c.length;o<a;o++,u++)n[u]=c[o];return n}var c=function(r){return(r+1)%1e6};function o(){return e.useReducer(c,0)[1]}function a(r,t){return function(){var n=o();e.useLayoutEffect((function(){return r(),n(),function(){t(),n()}}),[])}}function i(r,n){return function(u){var c=o(),a=e.useRef(new Map),i=e.useRef(t.createProxy(n.getState(),a.current)),f=e.useRef(n.getState()),s=e.useCallback((function(){var e=n.getState(),u=t.createProxy(e,a.current);(function(r,e,n){var u=Object.values(r);if(n&&r["@@DURA"][t.DURA_PATCHES_SYMBOL].includes("@@DURA.REFRESH")&&r["@@DURA"].REFRESH.startsWith(n))return!1;var c=-1;for(;++c<u.length;){var o=u[c][t.DURA_PATCHES_SYMBOL];if((null==o?void 0:o.length)>0)if(o.some((function(r){return e.has(r)})))return!1}return!0})(u,a.current,r)||(i.current=u,f.current=e,a.current.clear(),c())}),[]);return e.useLayoutEffect((function(){return n.subscribe(s)}),[]),e.useLayoutEffect((function(){var r=n.getState();i.current=t.createProxy(r,a.current),f.current=r,a.current.clear(),c()}),u),i.current}}Object.defineProperty(exports,"defineStoreSlice",{enumerable:!0,get:function(){return r.defineStoreSlice}}),exports.configura=function(c){return function(){for(var o=[],f=0;f<arguments.length;f++)o[f]=arguments[f];var s=r.configura(c),l=s.apply(void 0,o);return function(){for(var r=[],c=0;c<arguments.length;c++)r[c]=arguments[c];var f=r.map((function(r){return r.namespace})).join("."),s=function(){return l.use.apply(l,r).refresh(f)},v=function(){return l.unUse.apply(l,r).refresh(f)},p=a(s,v),y=function(r){return void 0===r&&(r=[]),i(f,l)(r)},g=function(){var n=t.createActionsFactory(l);return e.useMemo((function(){return n.apply(void 0,u(o,r))}),[])},S=n(n({},l),{useMount:p,useStore:y,useActions:g});return S}}};
//# sourceMappingURL=index.js.map
